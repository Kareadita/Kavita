
<!-- we don't need to worry about ands/ors/statements. We can just show statements and pass the and/or for the dropdown, so that it's always the same rendering
    at the end/beginning we will process it into and/ors.
-->
<ng-container *ngIf="filterGroup.and && filterGroup.and.length > 0">
    AND
    <ng-container [ngTemplateOutlet]="statements" [ngTemplateOutletContext]="{ group: filterGroup.and }"></ng-container>
</ng-container>

<ng-container *ngIf="filterGroup.or && filterGroup.or.length > 0">
    OR
    <ng-container [ngTemplateOutlet]="statements" [ngTemplateOutletContext]="{ group: filterGroup, statements: filterGroup.statements }"></ng-container>
</ng-container>

<ng-container *ngIf="filterGroup.statements && filterGroup.statements.length > 0">
    <ng-container [ngTemplateOutlet]="statements" [ngTemplateOutletContext]="{ group: filterGroup, statements: filterGroup.statements }"></ng-container>
</ng-container>

<ng-template #statements let-group="group">
    <div class="row mb-2" *ngFor="let filterStmt of group.statements let i = index">
        <div class="col-md-1">
            <button class="btn btn-icon" (click)="addFilter('and')" ngbTooltip="Add Row">
                <i class="fa-solid fa-plus" aria-hidden="true"></i>
                <span class="visually-hidden">Add Row {{i + 1}}</span>
            </button>
            <button class="btn btn-icon" (click)="addFilter('or')">
                OR
            </button>
        </div>
        <div class="col-md-10">
            <app-metadata-row-filter [preset]="filterStmt" (filterStatement)="updateFilter(i, $event)"></app-metadata-row-filter>
        </div>
        <div class="col-md-1">
            <button class="btn btn-icon" (click)="removeFilter(i, group)" *ngIf="i > 0">
                <i class="fa-solid fa-minus" aria-hidden="true"></i>
                <span class="visually-hidden">Remove Row {{i}}</span>
            </button>
        </div>
    </div>
</ng-template>