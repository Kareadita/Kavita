<ng-container *ngIf="toggleService.toggleState$ | async as isOpen">
    <div class="phone-hidden">
        <div #collapse="ngbCollapse" [ngbCollapse]="!isOpen" (ngbCollapseChange)="setToggle($event)">
            <ng-container [ngTemplateOutlet]="filterSection"></ng-container>
        </div>
    </div>

    <div class="not-phone-hidden">
        <app-drawer #commentDrawer="drawer" [isOpen]="isOpen" [options]="{topOffset: 56}" (drawerClosed)="toggleService.set(false)">
            <h5 header>
                Filter
            </h5>
            <div body class="drawer-body">
                <ng-container [ngTemplateOutlet]="filterSection"></ng-container>
            </div>
        </app-drawer>
    </div>
</ng-container>

<ng-template #filterSection>
    <ng-template #globalFilterTooltip>This is library agnostic</ng-template>
    <div class="filter-section mx-auto pb-3" *ngIf="fullyLoaded">
      <div class="row justify-content-center g-0">
         <app-metadata-builder  [filterGroup]="filterV2!.groups[0]" (update)="handleFilters($event)"></app-metadata-builder>

          <div class="col-md-2 me-3">
              <form [formGroup]="sortGroup">
                  <div class="mb-3">
                      <label for="sort-options" class="form-label">Sort By</label>
                      <button class="btn btn-sm btn-secondary-outline" (click)="updateSortOrder()" style="height: 25px; padding-bottom: 0px;" [disabled]="filterSettings.sortDisabled">
                          <i class="fa fa-arrow-up" title="Ascending" *ngIf="isAscendingSort; else descSort"></i>
                          <ng-template #descSort>
                              <i class="fa fa-arrow-down" title="Descending"></i>
                          </ng-template>
                      </button>
                      <select id="sort-options" class="form-select" formControlName="sortField" style="height: 38px;">
                          <option [value]="SortField.SortName">Sort Name</option>
                          <option [value]="SortField.Created">Created</option>
                          <option [value]="SortField.LastModified">Last Modified</option>
                          <option [value]="SortField.LastChapterAdded">Item Added</option>
                          <option [value]="SortField.TimeToRead">Time to Read</option>
                          <option [value]="SortField.ReleaseYear">Release Year</option>
                      </select>
                  </div>
              </form>
          </div>
          <div class="col-md-2 me-3 mt-4">
              <button class="btn btn-secondary col-12" (click)="clear()">Clear</button>
          </div>
          <div class="col-md-2 me-3 mt-4">
              <button class="btn btn-primary col-12" (click)="apply()">Apply</button>
          </div>
      </div>
    </div>
</ng-template>
