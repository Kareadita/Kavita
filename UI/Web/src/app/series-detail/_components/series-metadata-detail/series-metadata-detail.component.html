<div class="row g-0 mt-2 mb-2">
    <app-read-more [text]="seriesSummary" [maxLength]="250"></app-read-more>
</div>

<div class="row g-0 mt-2 mb-2">
  <div class="col-md-4">
    <h5>Ratings</h5>
  </div>
  <div class="col-md-8">
    <app-external-rating [seriesId]="series.id" [userRating]="series.userRating" [hasUserRated]="series.hasUserRated" [libraryType]="libraryType"></app-external-rating>
  </div>
</div>


<ng-container *ngIf="WebLinks as links">
    <div class="row g-0 mt-2 mb-2" *ngIf="links.length > 0">
        <div class="col-md-4">
            <h5>Links</h5>
        </div>
        <div class="col-md-8">
            <a class="col me-1" [href]="link | safeHtml" target="_blank" rel="noopener noreferrer" *ngFor="let link of links" [title]="link">
                <img width="24" height="24" class="lazyload img-placeholder"
                    [src]="imageService.errorWebLinkImage"
                    [attr.data-src]="imageService.getWebLinkImage(link)"
                    (error)="imageService.updateErroredWebLinkImage($event)"
                    aria-hidden="true" alt="">
            </a>
        </div>
    </div>
</ng-container>


<app-metadata-detail [tags]="seriesMetadata.genres" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Genres" heading="Genres">
  <ng-template #titleTemplate let-item>{{item.title}}</ng-template>
</app-metadata-detail>

<app-metadata-detail [tags]="seriesMetadata.tags" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Tags" heading="Tags">
  <ng-template #titleTemplate let-item>{{item.title}}</ng-template>
</app-metadata-detail>


<div class="row g-0 mt-1" *ngIf="seriesMetadata.collectionTags && seriesMetadata.collectionTags.length > 0">
    <div class="col-md-4">
        <h5>Collections</h5>
    </div>
    <div class="col-md-8">
        <app-badge-expander [items]="seriesMetadata.collectionTags">
            <ng-template #badgeExpanderItem let-item let-position="idx">
                <app-tag-badge a11y-click="13,32" class="col-auto" (click)="navigate('collections', item.id)" [selectionMode]="TagBadgeCursor.Clickable">
                    {{item.title}}
                </app-tag-badge>
            </ng-template>
        </app-badge-expander>
    </div>
</div>

<div class="row g-0 mt-1" *ngIf="readingLists && readingLists.length > 0">
    <div class="col-md-4">
        <h5>Reading Lists</h5>
    </div>
    <div class="col-md-8">
        <app-badge-expander [items]="readingLists">
            <ng-template #badgeExpanderItem let-item let-position="idx">
                <app-tag-badge a11y-click="13,32" class="col-auto" (click)="navigate('lists', item.id)" [selectionMode]="TagBadgeCursor.Clickable">
                    <span *ngIf="item.promoted">
                        <i class="fa fa-angle-double-up" aria-hidden="true"></i>&nbsp;
                        <span class="visually-hidden">(promoted)</span>
                    </span>
                    {{item.title}}
                </app-tag-badge>
            </ng-template>
        </app-badge-expander>
    </div>
</div>

<app-metadata-detail [tags]="seriesMetadata.writers" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Writers" heading="Writers/Authors">
  <ng-template #itemTemplate let-item>
    <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
  </ng-template>
</app-metadata-detail>


<div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed" id="extended-series-metadata">
  <app-metadata-detail [tags]="seriesMetadata.coverArtists" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.CoverArtists" heading="Cover Artists">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

  <app-metadata-detail [tags]="seriesMetadata.characters" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Character" heading="Characters">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

  <app-metadata-detail [tags]="seriesMetadata.colorists" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Colorist" heading="Colorists">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

  <app-metadata-detail [tags]="seriesMetadata.editors" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Editor" heading="Editors">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

  <app-metadata-detail [tags]="seriesMetadata.inkers" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Inker" heading="Inkers">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

  <app-metadata-detail [tags]="seriesMetadata.letterers" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Letterer" heading="Letterers">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

  <app-metadata-detail [tags]="seriesMetadata.translators" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Translator" heading="Translators">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

  <app-metadata-detail [tags]="seriesMetadata.pencillers" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Penciller" heading="Pencillers">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

  <app-metadata-detail [tags]="seriesMetadata.publishers" [libraryId]="series.libraryId" [queryParam]="FilterQueryParam.Publisher" heading="Publishers">
    <ng-template #itemTemplate let-item>
      <app-person-badge a11y-click="13,32" class="col-auto" [person]="item"></app-person-badge>
    </ng-template>
  </app-metadata-detail>

</div>

<div class="row g-0">
    <hr class="col mt-3" *ngIf="hasExtendedProperties" >
    <a [class.hidden]="hasExtendedProperties" *ngIf="hasExtendedProperties"
       class="col col-md-auto align-self-end read-more-link" (click)="toggleView()">
            <i aria-hidden="true" class="fa fa-caret-{{isCollapsed ? 'down' : 'up'}} me-1" aria-controls="extended-series-metadata"></i>
            See {{isCollapsed ? 'More' : 'Less'}}
    </a>
</div>

<app-series-info-cards [series]="series" [seriesMetadata]="seriesMetadata" (goTo)="handleGoTo($event)" [hasReadingProgress]="hasReadingProgress"></app-series-info-cards>
