<div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Invite User</h4>
    <button type="button" class="close" aria-label="Close" (click)="close()">
    <span aria-hidden="true">&times;</span>
    </button>
</div>
<div class="modal-body">
    <p>
        Invite a user to your server. Enter their email in and we will send them an email to create an account.
    </p>

    <p *ngIf="!checkedAccessibility">
        <span class="spinner-border text-primary" style="width: 1.5rem; height: 1.5rem;" role="status" aria-hidden="true"></span>
        &nbsp;Checking accessibility of server...
    </p>
    

    <form [formGroup]="inviteForm">
        <div class="row no-gutters">
            <div class="form-group" style="width:100%">
                <label for="email">Email</label>
                <input class="form-control" type="email" id="email" formControlName="email" required>
                <div id="inviteForm-validations" class="invalid-feedback" *ngIf="inviteForm.dirty || inviteForm.touched">
                    <div *ngIf="email?.errors?.required">
                        This field is required
                    </div>
                </div>
            </div>
        </div>

        <ng-container *ngIf="emailLink !== '' && checkedAccessibility && !accessible">
            <p>Use this link to finish setting up the user account due to your server not being accessible outside your local network.</p>
            <a class="email-link" href="{{emailLink}}" target="_blank">{{emailLink}}</a>
        </ng-container>
    
        <div class="row no-gutters">
            <div class="col-md-6">
                <app-role-selector (selected)="updateRoleSelection($event)" [allowAdmin]="true"></app-role-selector>
            </div>

            <div class="col-md-6">
                <app-library-selector (selected)="updateLibrarySelection($event)"></app-library-selector>
            </div>
        </div>
    </form>

</div>
<div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="close()">
        Cancel
    </button>
    <button type="button" class="btn btn-primary" (click)="invite()" [disabled]="isSending || !inviteForm.valid || !checkedAccessibility || emailLink !== ''">
        <span *ngIf="isSending" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        <span>{{isSending ? 'Inviting...' : 'Invite'}}</span>
    </button>
</div>
